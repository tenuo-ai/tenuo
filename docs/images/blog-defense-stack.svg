<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 700">
  <defs>
    <linearGradient id="layer0" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#fbbf24"/>
      <stop offset="100%" style="stop-color:#f59e0b"/>
    </linearGradient>
    <linearGradient id="layer15" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#60a5fa"/>
      <stop offset="100%" style="stop-color:#3b82f6"/>
    </linearGradient>
    <linearGradient id="layer2" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#34d399"/>
      <stop offset="100%" style="stop-color:#10b981"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="600" height="700" fill="#0f172a"/>
  
  <!-- Title -->
  <text x="300" y="45" text-anchor="middle" fill="#f1f5f9" font-family="sans-serif" font-size="24" font-weight="bold">THE DEFENSE STACK</text>
  
  <!-- LLM Output -->
  <rect x="200" y="70" width="200" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="2"/>
  <text x="300" y="102" text-anchor="middle" fill="#94a3b8" font-family="monospace" font-size="14">LLM Output</text>
  
  <!-- Arrow 1 -->
  <path d="M300 120 L300 155" stroke="#475569" stroke-width="2"/>
  <polygon points="300,165 294,155 306,155" fill="#475569"/>
  
  <!-- Layer 0 -->
  <rect x="100" y="170" width="400" height="100" rx="12" fill="#1e293b" stroke="url(#layer0)" stroke-width="2"/>
  <text x="300" y="205" text-anchor="middle" fill="#fbbf24" font-family="monospace" font-size="16" font-weight="bold">LAYER 0: CLASSIFIERS</text>
  <text x="300" y="230" text-anchor="middle" fill="#94a3b8" font-family="sans-serif" font-size="13">Prompt injection detection</text>
  <text x="300" y="255" text-anchor="middle" fill="#fbbf24" font-family="sans-serif" font-size="12">üîî Fire alarm, not fire door</text>
  
  <!-- Arrow 2 -->
  <path d="M300 270 L300 305" stroke="#475569" stroke-width="2"/>
  <polygon points="300,315 294,305 306,305" fill="#475569"/>
  
  <!-- Layer 1.5 -->
  <rect x="100" y="320" width="400" height="130" rx="12" fill="#1e293b" stroke="url(#layer15)" stroke-width="2"/>
  <text x="300" y="355" text-anchor="middle" fill="#60a5fa" font-family="monospace" font-size="16" font-weight="bold">LAYER 1.5: SEMANTIC VALIDATION</text>
  
  <!-- Constraint boxes -->
  <rect x="130" y="375" width="100" height="35" rx="6" fill="#1e3a5f"/>
  <text x="180" y="398" text-anchor="middle" fill="#93c5fd" font-family="monospace" font-size="12">Subpath</text>
  
  <rect x="250" y="375" width="100" height="35" rx="6" fill="#1e3a5f"/>
  <text x="300" y="398" text-anchor="middle" fill="#93c5fd" font-family="monospace" font-size="12">UrlSafe</text>
  
  <rect x="370" y="375" width="100" height="35" rx="6" fill="#1e3a5f"/>
  <text x="420" y="398" text-anchor="middle" fill="#93c5fd" font-family="monospace" font-size="12">Shlex</text>
  
  <text x="300" y="435" text-anchor="middle" fill="#60a5fa" font-family="sans-serif" font-size="12">üìñ Parse like the executor does</text>
  
  <!-- Arrow 3 -->
  <path d="M300 450 L300 485" stroke="#475569" stroke-width="2"/>
  <polygon points="300,495 294,485 306,485" fill="#475569"/>
  
  <!-- Layer 2 -->
  <rect x="100" y="500" width="400" height="130" rx="12" fill="#1e293b" stroke="url(#layer2)" stroke-width="2"/>
  <text x="300" y="535" text-anchor="middle" fill="#34d399" font-family="monospace" font-size="16" font-weight="bold">LAYER 2: EXECUTION GUARDS</text>
  
  <!-- Guard boxes -->
  <rect x="130" y="555" width="100" height="35" rx="6" fill="#134e4a"/>
  <text x="180" y="578" text-anchor="middle" fill="#6ee7b7" font-family="monospace" font-size="12">path_jail</text>
  
  <rect x="250" y="555" width="100" height="35" rx="6" fill="#134e4a"/>
  <text x="300" y="578" text-anchor="middle" fill="#6ee7b7" font-family="monospace" font-size="12">url_jail</text>
  
  <rect x="370" y="555" width="100" height="35" rx="6" fill="#134e4a"/>
  <text x="420" y="578" text-anchor="middle" fill="#6ee7b7" font-family="monospace" font-size="12">proc_jail</text>
  
  <text x="300" y="615" text-anchor="middle" fill="#34d399" font-family="sans-serif" font-size="12">üó∫Ô∏è Check reality at execution time</text>
  
  <!-- Arrow 4 -->
  <path d="M300 630 L300 655" stroke="#475569" stroke-width="2"/>
  <polygon points="300,665 294,655 306,655" fill="#475569"/>
  
  <!-- Execution -->
  <rect x="200" y="670" width="200" height="25" rx="6" fill="#22c55e" opacity="0.3"/>
  <text x="300" y="688" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="12">‚úì SAFE EXECUTION</text>
</svg>

